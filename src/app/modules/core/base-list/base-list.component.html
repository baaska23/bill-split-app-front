<div class="base-list-container p-4">
  <h2 *ngIf="header" class="mb-3 text-xl font-semibold">
    {{ header }}
  </h2>

  <p-table [value]="data" [resizableColumns]="true" [reorderableColumns]="true">
    <ng-template pTemplate="header">
      <tr>
        <th *ngFor="let col of selectedColumns;" [pSortableColumn]="col.field">
          {{ col.header }}
          <p-sortIcon [field]="col.field"></p-sortIcon>
        </th>
      </tr>

      <tr *ngIf="showFilters">
        <th *ngFor="let col of selectedColumns; trackBy: trackByField">
          <ng-container [ngSwitch]="col.type">
            <input
              *ngSwitchCase="'text'"
              pInputText
              [ngModel]="filters[col.field]?.value"
              (ngModelChange)="onFilterValueChange(col.field, $event)"
              placeholder="Search {{ col.header }}"
            />
            <input
              *ngSwitchCase="'number'"
              type="number"
              pInputText
              [ngModel]="filters[col.field]?.value"
              (ngModelChange)="onFilterValueChange(col.field, $event)"
              placeholder="Filter {{ col.header }}"
            />
            <p-select
              *ngSwitchCase="'dropdown'"
              [options]="col.options"
              [ngModel]="filters[col.field]?.value"
              (ngModelChange)="onFilterValueChange(col.field, $event)"
              placeholder="Select {{ col.header }}"
              optionLabel="label"
              optionValue="value"
            ></p-select>
            <p-datepicker
              *ngSwitchCase="'date'"
              [ngModel]="filters[col.field]?.value"
              (ngModelChange)="onFilterValueChange(col.field, $event)"
              dateFormat="yy-mm-dd"
              placeholder="Filter date"
            ></p-datepicker>
            <p-checkbox
              *ngSwitchCase="'boolean'"
              [ngModel]="filters[col.field]?.value"
              (ngModelChange)="onFilterValueChange(col.field, $event)"
              binary="true"
            ></p-checkbox>
          </ng-container>
        </th>
      </tr>
    </ng-template>

    <ng-template pTemplate="body" let-rowData>
      <tr>
        <td *ngFor="let col of selectedColumns; trackBy: trackByField">
          <ng-container [ngSwitch]="col.type">
            <span *ngSwitchCase="'date'">{{ rowData[col.field] | date: 'short' }}</span>
            <span *ngSwitchCase="'number'">{{ rowData[col.field] | number }}</span>
            <i *ngSwitchCase="'boolean'" class="pi" [ngClass]="rowData[col.field] ? 'pi-check' : 'pi-times'"></i>
            <span *ngSwitchDefault>{{ rowData[col.field] }}</span>
          </ng-container>
        </td>
      </tr>
    </ng-template>

    <ng-template pTemplate="emptymessage">
      <tr>
        <td [attr.colspan]="selectedColumns.length" class="text-center">
          No records found
        </td>
      </tr>
    </ng-template>
  </p-table>

  <p-paginator
    *ngIf="showPaginator"
    [first]="first"
    [rows]="rowsPerPage"
    [totalRecords]="data.length"
    [rowsPerPageOptions]="rowsPerPageOptions"
    [showCurrentPageReport]="true"
    currentPageReportTemplate="Showing {first} to {last} of {totalRecords} entries"
    (onPageChange)="onPageChange($event)"
    class="mt-3"
  ></p-paginator>
</div>